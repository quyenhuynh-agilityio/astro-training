---
import BaseLayout from '@layouts/BaseLayout/index.astro';
import Hero from '@sections/HeroSection/index.astro';
import AboutSection from '@sections/AboutSection/index.astro';
import PropertySection from '@sections/PropertySection/index.astro';
import Footer from '@layouts/Footer/index.astro';
import TestimonialSection from '@sections/TestimonialSection/index.astro';
import AgentSection from '@sections/AgentSection/index.astro';
import type { HomePageType } from '@types-local/home';
import { loadQuery } from 'studio/lib/load-query';
import { homePageQuery } from '@queries/index';

const { data: homePage } = await loadQuery<HomePageType>({
  query: homePageQuery,
});

if (!homePage) {
  return Astro.redirect('/404');
}

const { header, hero, about, properties, feature, agent, testimonial, footer } =
  homePage;
---

<BaseLayout title="Home Page">
  <Hero
    title={hero.heading.title}
    subtitle={hero.heading.subtitle}
    labelBtn={hero.ctaText}
    logo={header.logo}
    navItems={header.navItems}
    ctaText={header.ctaText}
    image={hero.image}
  />
  <AboutSection
    title={about.title}
    description={about.description}
    image={about.image}
    buttonText={about.ctaText}
  />
  <PropertySection {properties} />
  <AgentSection
    title={agent?.title}
    description={agent?.description}
    cta={agent?.ctaText}
  />
  <AboutSection
    reverse
    title={feature.title}
    description={feature.description}
    image={feature.image}
    buttonText={feature.ctaText}
  />
  <TestimonialSection
    testimonials={(testimonial?.testimonials || []).map((t: any) => ({
      name: t.author,
      role: t.role,
      image: t?.image,
      quote: t.quote,
    }))}
  />
  <Footer
    logo={footer.logo}
    socialLinks={footer.socialLinks}
    ctaText={footer.ctaText}
    columns={footer.links}
  />
</BaseLayout>
