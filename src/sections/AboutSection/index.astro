---
import PortableText from '@components/PortableText/index.astro';
import SanityImage from '@components/SanityImage/index.astro';
import Button from '@components/Button';
import Heading from '@components/Heading/index.astro';
import { cn } from '@lib/utils';
import type { SanityImageType } from '@types-local/common';

interface AboutSectionProps {
  title: string;
  description: string;
  image?: SanityImageType;
  ctaText?: string;
  reverse?: boolean;
  sectionClassName?: string;
  containerClassName?: string;
  imageWrapperClassName?: string;
  textWrapperClassName?: string;
}

const {
  title,
  description,
  image,
  ctaText,
  reverse = false,
  sectionClassName = '',
  containerClassName = '',
  imageWrapperClassName = '',
  textWrapperClassName = '',
} = Astro.props as AboutSectionProps;

const imageNode = image
  ? { _type: 'image', asset: image.asset, alt: image.alt || 'About Image' }
  : null;
---

<section class={cn('w-full py-16', sectionClassName)}>
  <div
    class={cn(
      'max-w-7xl flex flex-col md:flex-row items-center gap-12 px-6 md:px-12',
      reverse && 'md:flex-row-reverse',
      containerClassName
    )}
  >
    {
      imageNode && (
        <div class={cn('flex-1', imageWrapperClassName)}>
          <div class="rounded-3xl overflow-hidden shadow-lg">
            <SanityImage
              node={imageNode}
              width={604}
              height={557}
              sizes="(max-width: 768px) 100vw, 604px"
              class="object-cover"
              loading="lazy"
            />
          </div>
        </div>
      )
    }

    <div class={cn('flex-1', textWrapperClassName)}>
      <Heading {title} />
      <div class="text-gray-600 mb-8 leading-relaxed">
        <PortableText value={description} />
      </div>
      {
        ctaText && (
          <Button className="py-5 px-10" variant="secondary" rightIcon="path">
            {ctaText}
          </Button>
        )
      }
    </div>
  </div>
</section>
