---
import { Icons } from '@components/Icons';
import DetailItem from '@components/DetailItem';
import PortableText from '@components/PortableText/index.astro';
import SanityImage from '@components/SanityImage/index.astro';
import type { Property } from '@types-local/property';

interface Props {
  property: Property;
}

const { property } = Astro.props as Props;

const { mainImage, galleryImages, details, description, features } =
  property || {};
---

<section class="bg-gray-50 py-8">
  <div class="max-w-6xl mx-auto px-4">
    <!-- Images -->
    <div class="mb-8 lg:grid lg:grid-cols-3 lg:gap-4">
      <!-- Main Image -->
      <div class="lg:col-span-2">
        <SanityImage
          node={mainImage}
          sizes="(max-width: 768px) 100vw, (max-width: 1024px) 66vw, 960px"
          className="w-full h-250 sm:h-350 lg:h-450 object-cover rounded-2xl"
          loading="eager"
        />
      </div>

      <!-- Thumbnails -->
      <div class="mt-4 lg:mt-0">
        <div class="grid grid-cols-2 gap-2 lg:grid-cols-1">
          {
            (galleryImages || [])
              .slice(1, 7)
              .map((image, i) => (
                <SanityImage
                  node={image}
                  sizes="(max-width: 768px) 33vw, (max-width: 1024px) 20vw, 480px"
                  className="w-32 h-24 sm:w-full sm:h-28 object-cover rounded-xl cursor-pointer flex-shrink-0 hover:opacity-80 transition"
                  loading="eager"
                />
              ))
          }
        </div>
      </div>
    </div>

    <!-- Details -->
    <div class="bg-white rounded-2xl shadow-sm p-6 mb-8">
      <h3 class="text-xl font-semibold mb-6">Details</h3>
      <div
        class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-6 text-center border-t border-accent"
      >
        <DetailItem
          icon={Icons.Bed}
          value={details?.beds}
          label="Beds"
          bordered
        />
        <DetailItem
          icon={Icons.Shower}
          value={details?.baths}
          label="Baths"
          bordered
        />
        <DetailItem icon={Icons.Size} value={details?.area} bordered />
        <DetailItem
          icon={Icons.Garage}
          value={details?.garage}
          label="Garage"
          bordered
        />
        <DetailItem icon={Icons.Bed} value={`Built ${details?.yearBuilt}`} />
      </div>
    </div>

    <!-- Description -->
    <div class="bg-white rounded-2xl shadow-sm p-6 mb-8">
      <h3 class="text-xl font-semibold pb-4 border-b border-accent">
        Description
      </h3>
      <div class="text-gray-700 whitespace-pre-line leading-relaxed pt-4">
        <PortableText value={description} />
      </div>
    </div>

    <!-- Features -->
    <div class="bg-white rounded-2xl shadow-sm p-6 mb-8">
      <h3 class="text-xl font-semibold py-4 border-b border-accent">
        Features
      </h3>
      <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3 mt-4">
        {
          (features || []).map((feature) => (
            <div class="flex items-center gap-2 text-gray-700 hover:text-primary transition">
              <Icons.Check />
              <span>{feature}</span>
            </div>
          ))
        }
      </div>
    </div>
  </div>
</section>
